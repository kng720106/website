<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…±é€šãƒ†ã‚¹ãƒˆ æƒ…å ±â…  é‡ç‚¹å¯¾ç­–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ v2.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans JP', sans-serif; background-color: #fdfaf6; color: #374151; }
        .chart-container { 
            position: relative; 
            width: 100%; 
            height: 300px; 
            max-height: 400px;
        }
        .nav-btn.active { background-color: #d97706; color: white; box-shadow: 0 2px 4px rgba(217, 119, 6, 0.3); }
        .card { background-color: white; border-radius: 1rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03); padding: 1.5rem; transition: transform 0.2s, box-shadow 0.2s; border: 1px solid #f3f4f6; }
        .card:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
        .tab-content { display: none; opacity: 0; transition: opacity 0.3s ease-in-out; }
        .tab-content.active { display: block; opacity: 1; }
        .code-block { font-family: 'Menlo', 'Monaco', 'Courier New', monospace; background: #1f2937; color: #a5f3fc; padding: 1rem; border-radius: 0.5rem; overflow-x: auto; font-size: 0.85rem; }
        
        /* DNS Simulation Styles */
        .dns-step { opacity: 0.3; transition: opacity 0.5s; border-left: 4px solid #e5e7eb; padding-left: 1rem; margin-bottom: 1rem; }
        .dns-step.active { opacity: 1; border-left-color: #3b82f6; }
        
        /* Quiz Styles */
        .quiz-option:checked + label { background-color: #eff6ff; border-color: #3b82f6; color: #1e40af; }
    </style>
    <!-- Chosen Palette: Extended Warm Neutrals with Semantic Accents -->
    <!-- Structure: Added 'Quiz' tab. Enhanced Algorithm with Bubble Sort. Enhanced Data with Scatter Plots. Added DNS flow. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-white shadow-sm sticky top-0 z-50 backdrop-blur-sm bg-opacity-90">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 flex justify-between items-center">
            <h1 class="text-xl font-bold text-gray-800 flex items-center gap-2 cursor-pointer" onclick="switchTab('overview')">
                <span class="text-amber-600 text-2xl bg-amber-100 p-1 rounded-lg">ğŸ“</span> 
                <span class="hidden sm:inline">å…±é€šãƒ†ã‚¹ãƒˆ æƒ…å ±â…  å¯¾ç­–</span>
                <span class="sm:hidden">æƒ…å ±â…  å¯¾ç­–</span>
            </h1>
            
            <!-- Desktop Nav -->
            <nav class="hidden lg:flex gap-1">
                <button onclick="switchTab('overview')" id="nav-overview" class="nav-btn active px-3 py-2 rounded-lg text-sm font-bold transition-all">æ¦‚è¦</button>
                <button onclick="switchTab('society')" id="nav-society" class="nav-btn px-3 py-2 rounded-lg text-sm font-medium hover:bg-amber-50 text-gray-600 transition-all">æƒ…å ±ç¤¾ä¼š</button>
                <button onclick="switchTab('network')" id="nav-network" class="nav-btn px-3 py-2 rounded-lg text-sm font-medium hover:bg-amber-50 text-gray-600 transition-all">NW</button>
                <button onclick="switchTab('algo')" id="nav-algo" class="nav-btn px-3 py-2 rounded-lg text-sm font-medium hover:bg-amber-50 text-gray-600 transition-all">ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </button>
                <button onclick="switchTab('data')" id="nav-data" class="nav-btn px-3 py-2 rounded-lg text-sm font-medium hover:bg-amber-50 text-gray-600 transition-all">ãƒ‡ãƒ¼ã‚¿</button>
                <button onclick="switchTab('quiz')" id="nav-quiz" class="nav-btn px-3 py-2 rounded-lg text-sm font-bold bg-indigo-50 text-indigo-700 hover:bg-indigo-100 transition-all ml-2">å®Ÿæˆ¦æ¼”ç¿’</button>
            </nav>

            <!-- Mobile Menu Toggle -->
            <button onclick="toggleMobileMenu()" class="lg:hidden text-gray-600 p-2 rounded hover:bg-gray-100 focus:outline-none">
                <span class="text-2xl">â˜°</span>
            </button>
        </div>

        <!-- Mobile Nav -->
        <div id="mobile-menu" class="hidden lg:hidden bg-white border-t px-4 py-2 shadow-lg absolute w-full left-0 z-50">
            <div class="grid grid-cols-2 gap-2">
                <button onclick="switchTab('overview')" class="text-left px-4 py-3 rounded bg-gray-50 hover:bg-amber-50 text-sm">ğŸ  æ¦‚è¦</button>
                <button onclick="switchTab('society')" class="text-left px-4 py-3 rounded bg-gray-50 hover:bg-amber-50 text-sm">ğŸ”’ ç¤¾ä¼š</button>
                <button onclick="switchTab('network')" class="text-left px-4 py-3 rounded bg-gray-50 hover:bg-amber-50 text-sm">ğŸŒ NW</button>
                <button onclick="switchTab('algo')" class="text-left px-4 py-3 rounded bg-gray-50 hover:bg-amber-50 text-sm">âš¡ ã‚¢ãƒ«ã‚´</button>
                <button onclick="switchTab('data')" class="text-left px-4 py-3 rounded bg-gray-50 hover:bg-amber-50 text-sm">ğŸ“Š ãƒ‡ãƒ¼ã‚¿</button>
                <button onclick="switchTab('quiz')" class="text-left px-4 py-3 rounded bg-indigo-50 text-indigo-700 font-bold col-span-2 text-center text-sm">ğŸ“ å®Ÿæˆ¦æ¼”ç¿’ãƒ¢ãƒ¼ãƒ‰</button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 w-full relative">

        <!-- Overview Section -->
        <section id="overview" class="tab-content active space-y-8">
            <div class="bg-gradient-to-r from-amber-500 to-orange-400 p-6 rounded-2xl text-white shadow-lg">
                <h2 class="text-3xl font-bold mb-2">å­¦ç¿’ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã¸ã‚ˆã†ã“ã</h2>
                <p class="opacity-90">
                    å…±é€šãƒ†ã‚¹ãƒˆã€Œæƒ…å ±â… ã€ã§å·®ãŒã¤ããƒã‚¤ãƒ³ãƒˆã‚’ã€ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¨å¯è¦–åŒ–ã§æ”»ç•¥ã—ã¾ã—ã‚‡ã†ã€‚
                    çŸ¥è­˜ã‚’ã‚¤ãƒ³ãƒ—ãƒƒãƒˆã—ãŸã‚‰ã€å³ç«¯ã®ã€Œå®Ÿæˆ¦æ¼”ç¿’ã€ã‚¿ãƒ–ã§ç†è§£åº¦ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="card border-t-4 border-gray-500 hover:bg-gray-50 cursor-pointer" onclick="switchTab('society')">
                    <div class="flex justify-between items-center mb-4">
                        <div class="text-3xl bg-gray-100 p-3 rounded-full">ğŸ”’</div>
                        <span class="text-xs font-bold text-gray-400">Information Society</span>
                    </div>
                    <h3 class="font-bold text-lg mb-1">æƒ…å ±ç¤¾ä¼šã¨æ³•è¦</h3>
                    <p class="text-sm text-gray-500">èªè¨¼ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã€è‘—ä½œæ¨©æ³•</p>
                </div>
                <div class="card border-t-4 border-blue-500 hover:bg-blue-50 cursor-pointer" onclick="switchTab('network')">
                    <div class="flex justify-between items-center mb-4">
                        <div class="text-3xl bg-blue-100 p-3 rounded-full">ğŸŒ</div>
                        <span class="text-xs font-bold text-blue-400">Network</span>
                    </div>
                    <h3 class="font-bold text-lg mb-1">ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯</h3>
                    <p class="text-sm text-gray-500">OSIå‚ç…§ãƒ¢ãƒ‡ãƒ«ã€DNSã€ãƒ—ãƒ­ãƒˆã‚³ãƒ«</p>
                </div>
                <div class="card border-t-4 border-green-500 hover:bg-green-50 cursor-pointer" onclick="switchTab('algo')">
                    <div class="flex justify-between items-center mb-4">
                        <div class="text-3xl bg-green-100 p-3 rounded-full">âš¡</div>
                        <span class="text-xs font-bold text-green-400">Algorithms</span>
                    </div>
                    <h3 class="font-bold text-lg mb-1">ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </h3>
                    <p class="text-sm text-gray-500">æ¢ç´¢ã€æ•´åˆ—ã€è¨ˆç®—é‡ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°</p>
                </div>
                <div class="card border-t-4 border-purple-500 hover:bg-purple-50 cursor-pointer" onclick="switchTab('data')">
                    <div class="flex justify-between items-center mb-4">
                        <div class="text-3xl bg-purple-100 p-3 rounded-full">ğŸ“Š</div>
                        <span class="text-xs font-bold text-purple-400">Data Science</span>
                    </div>
                    <h3 class="font-bold text-lg mb-1">ãƒ‡ãƒ¼ã‚¿ã®æ´»ç”¨</h3>
                    <p class="text-sm text-gray-500">ç›¸é–¢ã€ä»£è¡¨å€¤ã€ãƒ‡ã‚¸ã‚¿ãƒ«åŒ–</p>
                </div>
            </div>

            <!-- Key Terms Section -->
            <div class="card">
                <h3 class="font-bold text-xl mb-4 text-gray-800">ğŸ“Œ ç›´å‰ãƒã‚§ãƒƒã‚¯ï¼é‡è¦ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰</h3>
                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-y-4 gap-x-8 text-sm">
                    <div class="p-2 border-b border-gray-100"><span class="font-bold text-amber-600 block">äºŒè¦ç´ èªè¨¼</span>çŸ¥è­˜ãƒ»æ‰€æŒãƒ»ç”Ÿä½“ã®3è¦ç´ ã‹ã‚‰2ã¤ä»¥ä¸Šã‚’çµ„ã¿åˆã‚ã›ã‚‹ã€‚</div>
                    <div class="p-2 border-b border-gray-100"><span class="font-bold text-amber-600 block">DNS</span>ãƒ‰ãƒ¡ã‚¤ãƒ³åã¨IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å¤‰æ›ã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã€‚</div>
                    <div class="p-2 border-b border-gray-100"><span class="font-bold text-amber-600 block">ãƒ¢ãƒ³ãƒ†ã‚«ãƒ«ãƒ­æ³•</span>ä¹±æ•°ã‚’ç”¨ã„ãŸã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ‰‹æ³•ã€‚</div>
                    <div class="p-2 border-b border-gray-100"><span class="font-bold text-amber-600 block">äºŒåˆ†æ¢ç´¢</span>æ•´åˆ—æ¸ˆã¿ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦ã€ç¯„å›²ã‚’åŠåˆ†ã«çµã‚ŠãªãŒã‚‰æ¢ã™ã€‚</div>
                    <div class="p-2 border-b border-gray-100"><span class="font-bold text-amber-600 block">ä¸­å¤®å€¤</span>ãƒ‡ãƒ¼ã‚¿ã‚’é †ã«ä¸¦ã¹ãŸæ™‚ã®ä¸­å¤®ã®å€¤ã€‚å¤–ã‚Œå€¤ã«å¼·ã„ã€‚</div>
                    <div class="p-2 border-b border-gray-100"><span class="font-bold text-amber-600 block">å…¬é–‹éµæš—å·</span>å—ä¿¡è€…ã®å…¬é–‹éµã§æš—å·åŒ–ã—ã€å—ä¿¡è€…ã®ç§˜å¯†éµã§å¾©å·ã™ã‚‹ã€‚</div>
                </div>
            </div>
        </section>

        <!-- Society Section -->
        <section id="society" class="tab-content space-y-6">
            <h2 class="text-2xl font-bold text-gray-800 border-b pb-2">æƒ…å ±ç¤¾ä¼šã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</h2>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- 2FA Interactive -->
                <div class="card bg-white">
                    <h3 class="font-bold text-lg mb-3 text-amber-700 flex items-center gap-2">
                        <span>ğŸ”‘</span> äºŒè¦ç´ èªè¨¼ãƒã‚§ãƒƒã‚«ãƒ¼
                    </h3>
                    <p class="text-sm text-gray-600 mb-4">ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’é«˜ã‚ã‚‹ã«ã¯ã€Œç•°ãªã‚‹ç¨®é¡ã®è¦ç´ ã€ãŒå¿…è¦ã§ã™ã€‚è¦ç´ ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦çµ„ã¿åˆã‚ã›ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã—ã‚‡ã†ã€‚</p>
                    
                    <div class="flex flex-wrap gap-2 mb-6">
                        <button onclick="toggleAuth('pass')" id="btn-pass" class="px-4 py-2 rounded-full border-2 border-gray-200 text-sm font-medium transition hover:bg-gray-50">ğŸ§  ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ (çŸ¥è­˜)</button>
                        <button onclick="toggleAuth('pin')" id="btn-pin" class="px-4 py-2 rounded-full border-2 border-gray-200 text-sm font-medium transition hover:bg-gray-50">ğŸ§  æš—è¨¼ç•ªå· (çŸ¥è­˜)</button>
                        <button onclick="toggleAuth('phone')" id="btn-phone" class="px-4 py-2 rounded-full border-2 border-gray-200 text-sm font-medium transition hover:bg-gray-50">ğŸ“± ã‚¹ãƒãƒ› (æ‰€æŒ)</button>
                        <button onclick="toggleAuth('card')" id="btn-card" class="px-4 py-2 rounded-full border-2 border-gray-200 text-sm font-medium transition hover:bg-gray-50">ğŸ’³ ICã‚«ãƒ¼ãƒ‰ (æ‰€æŒ)</button>
                        <button onclick="toggleAuth('finger')" id="btn-finger" class="px-4 py-2 rounded-full border-2 border-gray-200 text-sm font-medium transition hover:bg-gray-50">ğŸ‘† æŒ‡ç´‹ (ç”Ÿä½“)</button>
                        <button onclick="toggleAuth('face')" id="btn-face" class="px-4 py-2 rounded-full border-2 border-gray-200 text-sm font-medium transition hover:bg-gray-50">ğŸ™‚ é¡” (ç”Ÿä½“)</button>
                    </div>

                    <div id="auth-display" class="bg-gray-100 rounded-lg p-6 text-center transition-colors duration-300">
                        <div class="text-gray-400 font-bold">è¦ç´ ã‚’é¸æŠã—ã¦ãã ã•ã„</div>
                    </div>
                </div>

                <!-- Copyright Quiz -->
                <div class="card bg-blue-50 border border-blue-100">
                    <h3 class="font-bold text-lg mb-3 text-blue-800 flex items-center gap-2">
                        <span>Â©ï¸</span> è‘—ä½œæ¨©ãƒ»æ³•è¦ã®ãƒã‚¤ãƒ³ãƒˆ
                    </h3>
                    <div class="space-y-3">
                        <div class="bg-white p-3 rounded shadow-sm">
                            <span class="text-xs font-bold text-green-600 bg-green-100 px-2 py-1 rounded">OK</span>
                            <span class="text-sm ml-2">è‡ªåˆ†ãŒè¦‹ã‚‹ãŸã‚ã«TVç•ªçµ„ã‚’éŒ²ç”» (ç§çš„ä½¿ç”¨)</span>
                        </div>
                        <div class="bg-white p-3 rounded shadow-sm">
                            <span class="text-xs font-bold text-red-600 bg-red-100 px-2 py-1 rounded">NG</span>
                            <span class="text-sm ml-2">è²·ã£ãŸCDã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ã‚¯ãƒ©ã‚¹å…¨å“¡ã«é…ã‚‹ (ç§çš„ä½¿ç”¨ã®ç¯„å›²å¤–)</span>
                        </div>
                        <div class="bg-white p-3 rounded shadow-sm">
                            <span class="text-xs font-bold text-red-600 bg-red-100 px-2 py-1 rounded">NG</span>
                            <span class="text-sm ml-2">å¥½ããªã‚¢ã‚¤ãƒ‰ãƒ«ã®å†™çœŸã‚’SNSã‚¢ã‚¤ã‚³ãƒ³ã«ã™ã‚‹ (å…¬è¡†é€ä¿¡æ¨©ä¾µå®³)</span>
                        </div>
                        <div class="bg-white p-3 rounded shadow-sm">
                            <span class="text-xs font-bold text-green-600 bg-green-100 px-2 py-1 rounded">OK</span>
                            <span class="text-sm ml-2">æˆæ¥­ã®èª²é¡Œãƒ¬ãƒãƒ¼ãƒˆã§ã€å‡ºå…¸ã‚’æ˜è¨˜ã—ã¦æ–‡ç« ã‚’å¼•ç”¨ (å¼•ç”¨ã®è¦ä»¶)</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Network Section -->
        <section id="network" class="tab-content space-y-6">
            <h2 class="text-2xl font-bold text-gray-800 border-b pb-2">æƒ…å ±é€šä¿¡ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯</h2>

            <!-- DNS Simulator -->
            <div class="card bg-white">
                <h3 class="font-bold text-lg mb-4 text-indigo-700 flex items-center gap-2">
                    <span>ğŸŒ</span> DNSã®ä»•çµ„ã¿ (åå‰è§£æ±ºã®æ—…)
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="col-span-1 space-y-4">
                        <p class="text-sm text-gray-600">ãƒ–ãƒ©ã‚¦ã‚¶ã«URLã‚’å…¥åŠ›ã—ã¦ã‹ã‚‰ã€ã‚µã‚¤ãƒˆãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¾ã§ã®è£å´ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>
                        <button onclick="runDNSSimulation()" class="w-full bg-indigo-600 text-white py-2 rounded shadow hover:bg-indigo-700 transition">
                            â–¶ï¸ `example.jp` ã«ã‚¢ã‚¯ã‚»ã‚¹ï¼
                        </button>
                        <button onclick="resetDNS()" class="w-full bg-gray-200 text-gray-600 py-2 rounded hover:bg-gray-300 transition text-sm">
                            ãƒªã‚»ãƒƒãƒˆ
                        </button>
                    </div>
                    <div class="col-span-2 bg-gray-50 p-4 rounded-lg h-64 overflow-y-auto" id="dns-log-container">
                        <div id="dns-step-1" class="dns-step">
                            <div class="font-bold text-sm text-gray-500">Step 1: å•ã„åˆã‚ã›</div>
                            <div class="text-sm">PCã€Œã­ãˆã€`example.jp` ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹æ•™ãˆã¦ï¼Ÿã€â†’ <span class="font-bold">DNSã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚µãƒ¼ãƒ</span>ã¸</div>
                        </div>
                        <div id="dns-step-2" class="dns-step">
                            <div class="font-bold text-sm text-gray-500">Step 2: ãƒ«ãƒ¼ãƒˆã¸ã®æ—…</div>
                            <div class="text-sm">ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚µãƒ¼ãƒã€ŒçŸ¥ã‚‰ãªã„ã‹ã‚‰<span class="font-bold">ãƒ«ãƒ¼ãƒˆã‚µãƒ¼ãƒ</span>ã«èãã‚ã€‚`.jp` ã¯ã©ã“ï¼Ÿã€</div>
                        </div>
                        <div id="dns-step-3" class="dns-step">
                            <div class="font-bold text-sm text-gray-500">Step 3: TLDã‚µãƒ¼ãƒ</div>
                            <div class="text-sm">ãƒ«ãƒ¼ãƒˆã€Œ`.jp` ã®ç®¡ç†ã‚µãƒ¼ãƒã‚’ç´¹ä»‹ã™ã‚‹ã‚ˆã€â†’ <span class="font-bold">JPãƒ‰ãƒ¡ã‚¤ãƒ³ç®¡ç†ã‚µãƒ¼ãƒ</span>ã¸</div>
                        </div>
                        <div id="dns-step-4" class="dns-step">
                            <div class="font-bold text-sm text-gray-500">Step 4: æ¨©å¨DNSã‚µãƒ¼ãƒ</div>
                            <div class="text-sm">JPã‚µãƒ¼ãƒã€Œ`example.jp` ã®ç®¡ç†ã‚µãƒ¼ãƒã¯ã‚ã£ã¡ã ã‚ˆã€â†’ <span class="font-bold">example.jp ã®DNSã‚µãƒ¼ãƒ</span>ã¸</div>
                        </div>
                        <div id="dns-step-5" class="dns-step">
                            <div class="font-bold text-sm text-gray-500">Step 5: è§£æ±ºï¼</div>
                            <div class="text-sm">æ¨©å¨ã‚µãƒ¼ãƒã€ŒIPã¯ `192.0.2.1` ã ã‚ˆï¼ã€â†’ PCã«è¿”ç­” â†’ <span class="font-bold text-indigo-600">Webã‚µã‚¤ãƒˆè¡¨ç¤ºï¼</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Protocol Stack -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="card">
                    <h3 class="font-bold text-lg mb-2">OSIå‚ç…§ãƒ¢ãƒ‡ãƒ« (TCP/IP)</h3>
                    <div class="space-y-1 mt-4">
                        <div class="group relative bg-purple-100 p-3 rounded cursor-help border-l-4 border-purple-500">
                            <span class="font-bold text-purple-900">ç¬¬4å±¤ ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆå±¤</span>
                            <span class="float-right text-xs text-purple-600 font-mono">TCP / UDP</span>
                            <div class="hidden group-hover:block absolute z-10 bg-gray-800 text-white text-xs p-2 rounded w-64 -top-12 left-0 shadow-xl">
                                ä¿¡é ¼æ€§ã®ç¢ºä¿ã€ãƒãƒ¼ãƒˆç•ªå·ã«ã‚ˆã‚‹ã‚¢ãƒ—ãƒªã®è­˜åˆ¥ã€‚å®…é…ä¾¿ã®ã€Œå†é…é”ã€ã‚„ã€Œå®›åç¢ºèªã€ã®å½¹å‰²ã€‚
                            </div>
                        </div>
                        <div class="group relative bg-blue-100 p-3 rounded cursor-help border-l-4 border-blue-500">
                            <span class="font-bold text-blue-900">ç¬¬3å±¤ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å±¤</span>
                            <span class="float-right text-xs text-blue-600 font-mono">IP / ICMP</span>
                            <div class="hidden group-hover:block absolute z-10 bg-gray-800 text-white text-xs p-2 rounded w-64 -top-12 left-0 shadow-xl">
                                ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ï¼ˆçµŒè·¯åˆ¶å¾¡ï¼‰ã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«ã‚ˆã‚‹å®›å…ˆè­˜åˆ¥ã€‚ã‚«ãƒ¼ãƒŠãƒ“ã®å½¹å‰²ã€‚
                            </div>
                        </div>
                        <div class="group relative bg-green-100 p-3 rounded cursor-help border-l-4 border-green-500">
                            <span class="font-bold text-green-900">ç¬¬2å±¤ ãƒ‡ãƒ¼ã‚¿ãƒªãƒ³ã‚¯å±¤</span>
                            <span class="float-right text-xs text-green-600 font-mono">Ethernet / Wi-Fi</span>
                            <div class="hidden group-hover:block absolute z-10 bg-gray-800 text-white text-xs p-2 rounded w-64 -top-12 left-0 shadow-xl">
                                åŒä¸€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å†…ã§ã®é€šä¿¡ã€‚MACã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ä½¿ç”¨ã€‚ã‚¹ã‚¤ãƒƒãƒãƒ³ã‚°ãƒãƒ–ãŒæ´»èºã€‚
                            </div>
                        </div>
                        <div class="group relative bg-gray-100 p-3 rounded cursor-help border-l-4 border-gray-500">
                            <span class="font-bold text-gray-900">ç¬¬1å±¤ ç‰©ç†å±¤</span>
                            <span class="float-right text-xs text-gray-600 font-mono">Cable / Signal</span>
                            <div class="hidden group-hover:block absolute z-10 bg-gray-800 text-white text-xs p-2 rounded w-64 -top-12 left-0 shadow-xl">
                                é›»æ°—ä¿¡å·ã‚„å…‰ä¿¡å·ã¸ã®å¤‰æ›ã€‚LANã‚±ãƒ¼ãƒ–ãƒ«ã‚„ã‚³ãƒã‚¯ã‚¿ã®å½¢çŠ¶ã€‚
                            </div>
                        </div>
                    </div>
                    <p class="text-xs text-gray-400 mt-2 text-right">â€»å„å±¤ã«ãƒã‚¦ã‚¹ã‚’ä¹—ã›ã‚‹ã¨è©³ç´°ã‚’è¡¨ç¤º</p>
                </div>
                <div class="card">
                    <h3 class="font-bold text-lg mb-2">IPã‚¢ãƒ‰ãƒ¬ã‚¹è¨ˆç®—ãƒ¡ãƒ¢</h3>
                    <div class="text-sm space-y-4">
                        <p>IPv4ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯32ãƒ“ãƒƒãƒˆã€‚8ãƒ“ãƒƒãƒˆãšã¤4ã¤ã«åŒºåˆ‡ã‚‹ã€‚</p>
                        <div class="bg-gray-800 text-green-400 font-mono p-3 rounded text-center">
                            192.168.1.1<br>
                            â¬‡ï¸<br>
                            11000000.10101000.00000001.00000001
                        </div>
                        <p class="text-gray-600">
                            <span class="font-bold">DHCP:</span> ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨­å®šã®è‡ªå‹•åŒ–<br>
                            <span class="font-bold">NAT/NAPT:</span> ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã¨ã‚°ãƒ­ãƒ¼ãƒãƒ«IPã®å¤‰æ›
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Algorithms Section -->
        <section id="algo" class="tab-content space-y-6">
            <h2 class="text-2xl font-bold text-gray-800 border-b pb-2">ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¨è¨ˆç®—é‡</h2>

            <!-- Sorting Viz -->
            <div class="card">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="font-bold text-lg text-green-700 flex items-center gap-2">
                        <span>ğŸ”„</span> æ•´åˆ—ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ : åŸºæœ¬äº¤æ›æ³• (Bubble Sort)
                    </h3>
                    <div class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded">è¨ˆç®—é‡: $O(n^2)$</div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                    <div class="col-span-1 space-y-4">
                        <p class="text-sm text-gray-600">éš£ã‚Šåˆã†ãƒ‡ãƒ¼ã‚¿ã‚’æ¯”è¼ƒã—ã€å¤§ãã•ãŒé€†ãªã‚‰å…¥ã‚Œæ›¿ãˆã‚‹æ“ä½œã‚’ç¹°ã‚Šè¿”ã—ã¾ã™ã€‚</p>
                        <button onclick="startBubbleSort()" id="btn-sort-start" class="w-full bg-green-600 text-white py-2 rounded shadow hover:bg-green-700 transition">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
                        <button onclick="resetSort()" id="btn-sort-reset" class="w-full bg-gray-200 text-gray-600 py-2 rounded hover:bg-gray-300 transition text-sm">ãƒªã‚»ãƒƒãƒˆ</button>
                        <div id="sort-status" class="text-xs font-mono bg-gray-100 p-2 rounded h-20 overflow-y-auto">å¾…æ©Ÿä¸­...</div>
                    </div>
                    <div class="col-span-3">
                        <div class="chart-container">
                            <canvas id="sortChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Search Viz -->
            <div class="card">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="font-bold text-lg text-blue-700 flex items-center gap-2">
                        <span>ğŸ”</span> æ¢ç´¢ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ æ¯”è¼ƒ
                    </h3>
                    <div class="flex gap-2">
                         <span class="text-xs bg-red-100 text-red-800 px-2 py-1 rounded">ç·šå½¢: $O(n)$</span>
                         <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded">äºŒåˆ†: $O(\log n)$</span>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                    <div class="col-span-1 space-y-4">
                        <p class="text-sm text-gray-600">ã€Œ77ã€ã‚’æ¢ã—ã¾ã™ã€‚<br>äºŒåˆ†æ¢ç´¢ã¯ãƒ‡ãƒ¼ã‚¿ãŒ<span class="font-bold">æ•´åˆ—æ¸ˆã¿</span>ã§ã‚ã‚‹ã“ã¨ãŒæ¡ä»¶ã§ã™ã€‚</p>
                        <button onclick="runLinearSearch()" class="w-full bg-red-500 hover:bg-red-600 text-white py-2 rounded shadow transition text-sm">ç·šå½¢æ¢ç´¢ (Linear)</button>
                        <button onclick="runBinarySearch()" class="w-full bg-blue-500 hover:bg-blue-600 text-white py-2 rounded shadow transition text-sm">äºŒåˆ†æ¢ç´¢ (Binary)</button>
                    </div>
                    <div class="col-span-3">
                        <div class="chart-container">
                            <canvas id="searchChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Data Section -->
        <section id="data" class="tab-content space-y-6">
            <h2 class="text-2xl font-bold text-gray-800 border-b pb-2">ãƒ‡ãƒ¼ã‚¿ã®æ´»ç”¨</h2>

            <!-- Correlation Simulator -->
            <div class="card">
                <h3 class="font-bold text-lg mb-4 text-purple-700 flex items-center gap-2">
                    <span>ğŸ“ˆ</span> ç›¸é–¢é–¢ä¿‚ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="col-span-1 space-y-3">
                        <p class="text-sm text-gray-600">ç›¸é–¢ä¿‚æ•° $r$ ã«ã‚ˆã£ã¦æ•£å¸ƒå›³ã®å½¢çŠ¶ãŒã©ã†å¤‰ã‚ã‚‹ã‹ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚</p>
                        <button onclick="updateCorrelation(0.9)" class="w-full text-left px-4 py-2 bg-purple-50 hover:bg-purple-100 rounded text-sm text-purple-900 font-bold border border-purple-200">
                            å¼·ã„æ­£ã®ç›¸é–¢ ($r \approx 0.9$) <br><span class="text-xs font-normal text-gray-500">æ°—æ¸©ãŒä¸ŠãŒã‚‹ã¨ã‚¢ã‚¤ã‚¹ãŒå£²ã‚Œã‚‹</span>
                        </button>
                        <button onclick="updateCorrelation(-0.8)" class="w-full text-left px-4 py-2 bg-purple-50 hover:bg-purple-100 rounded text-sm text-purple-900 font-bold border border-purple-200">
                            è² ã®ç›¸é–¢ ($r \approx -0.8$) <br><span class="text-xs font-normal text-gray-500">ä¾¡æ ¼ãŒä¸ŠãŒã‚‹ã¨å£²ä¸ŠãŒæ¸›ã‚‹</span>
                        </button>
                        <button onclick="updateCorrelation(0.0)" class="w-full text-left px-4 py-2 bg-purple-50 hover:bg-purple-100 rounded text-sm text-purple-900 font-bold border border-purple-200">
                            ç›¸é–¢ãªã— ($r \approx 0$) <br><span class="text-xs font-normal text-gray-500">èº«é•·ã¨ãƒ†ã‚¹ãƒˆã®ç‚¹æ•°</span>
                        </button>
                    </div>
                    <div class="col-span-2">
                        <div class="chart-container">
                            <canvas id="scatterChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Mean vs Median -->
            <div class="card bg-gray-50">
                <h3 class="font-bold text-lg mb-4 text-gray-700">ä»£è¡¨å€¤ã®ç½  (å¹³å‡å€¤ vs ä¸­å¤®å€¤)</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                    <div>
                        <p class="text-sm text-gray-600 mb-4">
                            æ¥µç«¯ãªå€¤ï¼ˆå¤–ã‚Œå€¤ï¼‰ãŒã‚ã‚‹å ´åˆã€å¹³å‡å€¤ã¯å¤§ããå½±éŸ¿ã‚’å—ã‘ã¾ã™ãŒã€ä¸­å¤®å€¤ã¯ã»ã¨ã‚“ã©å¤‰åŒ–ã—ã¾ã›ã‚“ã€‚
                        </p>
                        <div class="bg-white p-4 rounded shadow-sm">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm font-bold">ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿:</span>
                                <span class="text-xs text-gray-400">[300, 350, 380, 400, 420] + ???</span>
                            </div>
                            <button onclick="toggleOutlier()" id="btn-toggle-outlier" class="w-full bg-orange-500 text-white py-2 rounded shadow hover:bg-orange-600 transition">
                                ğŸ’° è¶…å¯Œè£•å±¤ (å¹´å5000ä¸‡) ã‚’è¿½åŠ 
                            </button>
                        </div>
                    </div>
                    <div class="space-y-2">
                        <div class="flex justify-between items-center bg-white p-3 rounded border-l-4 border-blue-500">
                            <span class="text-sm text-gray-500">å¹³å‡å€¤ (Mean)</span>
                            <span id="stat-mean" class="font-mono font-bold text-xl text-blue-600">370</span>
                        </div>
                        <div class="flex justify-between items-center bg-white p-3 rounded border-l-4 border-green-500">
                            <span class="text-sm text-gray-500">ä¸­å¤®å€¤ (Median)</span>
                            <span id="stat-median" class="font-mono font-bold text-xl text-green-600">380</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Quiz Section -->
        <section id="quiz" class="tab-content space-y-6">
            <h2 class="text-2xl font-bold text-gray-800 border-b pb-2 text-indigo-700">å®Ÿæˆ¦ãƒŸãƒ‹ãƒ†ã‚¹ãƒˆ</h2>
            <p class="text-gray-600">ã“ã“ã¾ã§ã®å­¦ç¿’å†…å®¹ã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«å‡ºé¡Œã•ã‚Œã¾ã™ã€‚</p>

            <div id="quiz-container" class="space-y-6">
                <!-- Questions injected by JS -->
            </div>

            <div class="flex justify-center mt-8">
                <button onclick="checkQuiz()" class="bg-indigo-600 text-white px-8 py-3 rounded-lg font-bold shadow-lg hover:bg-indigo-700 transition transform hover:-translate-y-1">
                    æ¡ç‚¹ã™ã‚‹
                </button>
                <button onclick="renderQuiz()" class="ml-4 bg-gray-200 text-gray-700 px-6 py-3 rounded-lg font-bold hover:bg-gray-300 transition">
                    æ–°ã—ã„å•é¡Œ
                </button>
            </div>

            <div id="quiz-result" class="hidden mt-6 bg-yellow-50 border border-yellow-200 p-6 rounded-lg text-center">
                <h3 class="text-2xl font-bold text-gray-800 mb-2">çµæœç™ºè¡¨</h3>
                <p id="quiz-score" class="text-4xl font-bold text-indigo-600 mb-2">-- / --</p>
                <p id="quiz-comment" class="text-gray-600">ã‚³ãƒ¡ãƒ³ãƒˆãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™</p>
            </div>
        </section>

    </main>

    <footer class="bg-gray-800 text-white py-10 mt-12">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <h2 class="text-lg font-bold mb-4 text-gray-400">å…±é€šãƒ†ã‚¹ãƒˆ æƒ…å ±â…  å¯¾ç­–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h2>
            <div class="flex justify-center gap-4 text-sm text-gray-500">
                <span>Â© 2024 Exam Prep Tools</span>
                <span>â€¢</span>
                <span>ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </span>
                <span>â€¢</span>
                <span>ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ã‚¹</span>
                <span>â€¢</span>
                <span>ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯</span>
            </div>
            <p class="mt-8 text-xs text-gray-600">
                æœ¬ãƒ„ãƒ¼ãƒ«ã¯å­¦ç¿’æ”¯æ´ã‚’ç›®çš„ã¨ã—ãŸã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã§ã‚ã‚Šã€å®Ÿéš›ã®è©¦é¨“å•é¡Œã®çš„ä¸­ã‚’ä¿è¨¼ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚<br>
                Canvas APIãŠã‚ˆã³Chart.jsã‚’ä½¿ç”¨ã—ã¦ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã§å‹•ä½œã—ã¦ã„ã¾ã™ã€‚
            </p>
        </div>
    </footer>

    <script>
        // --- State Management ---
        const state = {
            auth: new Set(),
            sortArr: [],
            isSorting: false,
            outlierAdded: false,
            baseIncome: [300, 350, 380, 400, 420],
        };

        // --- Navigation ---
        function switchTab(id) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(el => el.classList.remove('active'));
            
            document.getElementById(id).classList.add('active');
            const navBtn = document.getElementById('nav-' + id);
            if(navBtn) navBtn.classList.add('active');
            
            document.getElementById('mobile-menu').classList.add('hidden');
            
            // Lazy Load / Refresh Charts
            if(id === 'algo') {
                initSortChart();
                initSearchChart();
            }
            if(id === 'data') {
                initScatterChart();
            }
            if(id === 'quiz') {
                renderQuiz();
            }
        }

        function toggleMobileMenu() {
            document.getElementById('mobile-menu').classList.toggle('hidden');
        }

        // --- Society: Auth Logic ---
        function toggleAuth(type) {
            const btn = document.getElementById('btn-' + type);
            const display = document.getElementById('auth-display');
            
            // Map button ID to Auth Factor Type
            const factorMap = {
                'pass': 'knowledge', 'pin': 'knowledge',
                'phone': 'possession', 'card': 'possession',
                'finger': 'biometrics', 'face': 'biometrics'
            };
            const factor = factorMap[type];

            if (btn.classList.contains('bg-amber-100')) {
                btn.classList.remove('bg-amber-100', 'text-amber-800', 'border-amber-400');
                btn.classList.add('border-gray-200');
                state.auth.delete(type);
            } else {
                btn.classList.add('bg-amber-100', 'text-amber-800', 'border-amber-400');
                btn.classList.remove('border-gray-200');
                state.auth.add(type);
            }

            // Calculate distinct factors
            const selectedFactors = new Set();
            state.auth.forEach(t => selectedFactors.add(factorMap[t]));
            
            const count = selectedFactors.size;
            
            if (count === 0) {
                display.className = "bg-gray-100 rounded-lg p-6 text-center";
                display.innerHTML = `<div class="text-gray-400 font-bold">è¦ç´ ã‚’é¸æŠã—ã¦ãã ã•ã„</div>`;
            } else if (count >= 2) {
                display.className = "bg-green-100 border border-green-300 rounded-lg p-6 text-center";
                display.innerHTML = `
                    <div class="text-3xl mb-2">âœ… èªè¨¼æˆåŠŸ</div>
                    <div class="font-bold text-green-800">äºŒè¦ç´ èªè¨¼ã®è¦ä»¶ã‚’æº€ãŸã—ã¦ã„ã¾ã™</div>
                    <div class="text-sm text-green-600 mt-1">é¸æŠã•ã‚ŒãŸè¦ç´ : ${count}ç¨®é¡</div>
                `;
            } else {
                // If 1 factor type but multiple items (e.g. 2 passwords)
                if (state.auth.size >= 2) {
                    display.className = "bg-red-50 border border-red-200 rounded-lg p-6 text-center";
                    display.innerHTML = `
                        <div class="text-3xl mb-2">âš ï¸ èªè¨¼å¼·åº¦ä¸è¶³</div>
                        <div class="font-bold text-red-700">è¦ç´ ã®ç¨®é¡ãŒé‡è¤‡ã—ã¦ã„ã¾ã™</div>
                        <div class="text-sm text-red-600 mt-1">ã€ŒäºŒæ®µéšã€ã§ã™ãŒã€ŒäºŒè¦ç´ ã€ã§ã¯ã‚ã‚Šã¾ã›ã‚“</div>
                    `;
                } else {
                    display.className = "bg-yellow-50 border border-yellow-200 rounded-lg p-6 text-center";
                    display.innerHTML = `
                        <div class="text-xl mb-2 text-yellow-700">ã‚ã¨1ç¨®é¡å¿…è¦ã§ã™</div>
                    `;
                }
            }
        }

        // --- Network: DNS Simulation ---
        async function runDNSSimulation() {
            document.querySelectorAll('.dns-step').forEach(el => el.classList.remove('active'));
            const steps = [1, 2, 3, 4, 5];
            
            for (const step of steps) {
                const el = document.getElementById(`dns-step-${step}`);
                el.classList.add('active');
                el.scrollIntoView({ behavior: 'smooth', block: 'center' });
                await new Promise(r => setTimeout(r, 1200));
            }
        }

        function resetDNS() {
            document.querySelectorAll('.dns-step').forEach(el => el.classList.remove('active'));
            document.getElementById('dns-log-container').scrollTop = 0;
        }

        // --- Algorithm: Bubble Sort ---
        let sortChartInstance = null;

        function initSortChart() {
            if (sortChartInstance) return;
            const ctx = document.getElementById('sortChart').getContext('2d');
            state.sortArr = Array.from({length: 15}, () => Math.floor(Math.random() * 50) + 5);
            
            sortChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: state.sortArr.map((_, i) => i),
                    datasets: [{
                        data: state.sortArr,
                        backgroundColor: '#4ade80',
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: false,
                    plugins: { legend: { display: false } },
                    scales: { x: { display: false }, y: { display: false } }
                }
            });
        }

        async function startBubbleSort() {
            if (state.isSorting) return;
            state.isSorting = true;
            document.getElementById('btn-sort-start').disabled = true;
            document.getElementById('btn-sort-start').classList.add('opacity-50');
            const log = document.getElementById('sort-status');
            
            let arr = sortChartInstance.data.datasets[0].data;
            let n = arr.length;
            
            for (let i = 0; i < n - 1; i++) {
                for (let j = 0; j < n - i - 1; j++) {
                    // Highlight comparing
                    const colors = new Array(n).fill('#4ade80'); // Green default
                    colors[j] = '#fbbf24'; // Amber comparing
                    colors[j+1] = '#fbbf24';
                    // Mark sorted end
                    for(let k = n-i; k < n; k++) colors[k] = '#3b82f6'; // Blue sorted

                    sortChartInstance.data.datasets[0].backgroundColor = colors;
                    sortChartInstance.update();
                    log.innerHTML = `æ¯”è¼ƒä¸­: index[${j}] vs index[${j+1}]`;
                    
                    await new Promise(r => setTimeout(r, 100));

                    if (arr[j] > arr[j+1]) {
                        // Swap
                        let temp = arr[j];
                        arr[j] = arr[j+1];
                        arr[j+1] = temp;
                        
                        colors[j] = '#ef4444'; // Red swapped
                        colors[j+1] = '#ef4444';
                        sortChartInstance.data.datasets[0].backgroundColor = colors;
                        sortChartInstance.update();
                        await new Promise(r => setTimeout(r, 150));
                    }
                }
            }
            // All sorted
            sortChartInstance.data.datasets[0].backgroundColor = new Array(n).fill('#3b82f6');
            sortChartInstance.update();
            log.innerHTML = "æ•´åˆ—å®Œäº†ï¼";
            state.isSorting = false;
            document.getElementById('btn-sort-start').disabled = false;
            document.getElementById('btn-sort-start').classList.remove('opacity-50');
        }

        function resetSort() {
            if(state.isSorting) return;
            state.sortArr = Array.from({length: 15}, () => Math.floor(Math.random() * 50) + 5);
            sortChartInstance.data.datasets[0].data = state.sortArr;
            sortChartInstance.data.datasets[0].backgroundColor = '#4ade80';
            sortChartInstance.update();
            document.getElementById('sort-status').innerHTML = "ãƒªã‚»ãƒƒãƒˆå®Œäº†";
        }

        // --- Algorithm: Search (Simplified from v1) ---
        let searchChartInstance = null;
        function initSearchChart() {
            if(searchChartInstance) return;
            const ctx = document.getElementById('searchChart').getContext('2d');
            searchChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Array.from({length: 20}, (_, i) => i+1),
                    datasets: [{
                        data: Array.from({length: 20}, (_, i) => i*5 + 2),
                        backgroundColor: '#e5e7eb'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { y: { display: false } }
                }
            });
        }

        async function runLinearSearch() {
            const arr = searchChartInstance.data.datasets[0].data;
            const target = 72; // Index 14
            for(let i=0; i<arr.length; i++) {
                const colors = new Array(20).fill('#e5e7eb');
                colors[i] = '#f87171'; // Red check
                searchChartInstance.data.datasets[0].backgroundColor = colors;
                searchChartInstance.update();
                await new Promise(r => setTimeout(r, 100));
                if(i === 14) {
                    colors[i] = '#22c55e'; // Found
                    searchChartInstance.data.datasets[0].backgroundColor = colors;
                    searchChartInstance.update();
                    break;
                }
            }
        }

        async function runBinarySearch() {
            let low = 0, high = 19;
            const targetIndex = 14;
            while(low <= high) {
                let mid = Math.floor((low+high)/2);
                const colors = new Array(20).fill('#e5e7eb');
                
                // Highlight range
                for(let k=low; k<=high; k++) colors[k] = '#bfdbfe'; // Blue range
                colors[mid] = '#fbbf24'; // Check mid
                
                searchChartInstance.data.datasets[0].backgroundColor = colors;
                searchChartInstance.update();
                await new Promise(r => setTimeout(r, 600));

                if(mid === targetIndex) {
                    colors[mid] = '#22c55e';
                    searchChartInstance.data.datasets[0].backgroundColor = colors;
                    searchChartInstance.update();
                    break;
                } else if (mid < targetIndex) {
                    low = mid + 1;
                } else {
                    high = mid - 1;
                }
            }
        }


        // --- Data: Scatter Plot ---
        let scatterChartInstance = null;

        function generateData(correlation, count) {
            const data = [];
            for (let i = 0; i < count; i++) {
                let x = Math.random() * 100;
                let y = x * correlation + (Math.random() * 40 - 20); // Add noise
                if (correlation === 0) y = Math.random() * 100; // Pure random
                data.push({x, y});
            }
            return data;
        }

        function initScatterChart() {
            if (scatterChartInstance) return;
            const ctx = document.getElementById('scatterChart').getContext('2d');
            scatterChartInstance = new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: 'ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿',
                        data: generateData(0.9, 50),
                        backgroundColor: '#8b5cf6'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: { type: 'linear', position: 'bottom', title: {display: true, text: 'å¤‰æ•° X'} },
                        y: { title: {display: true, text: 'å¤‰æ•° Y'} }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        }

        function updateCorrelation(r) {
            const newData = generateData(r, 50);
            scatterChartInstance.data.datasets[0].data = newData;
            
            // Adjust label based on r
            let color = '#8b5cf6'; // purple
            if (r > 0.5) color = '#ef4444'; // red for positive
            if (r < -0.5) color = '#3b82f6'; // blue for negative
            if (r === 0) color = '#6b7280'; // gray
            
            scatterChartInstance.data.datasets[0].backgroundColor = color;
            scatterChartInstance.update();
        }

        // --- Data: Outlier Toggle ---
        function toggleOutlier() {
            const btn = document.getElementById('btn-toggle-outlier');
            const meanDisplay = document.getElementById('stat-mean');
            const medianDisplay = document.getElementById('stat-median');
            
            let currentArr = [...state.baseIncome];
            
            if (!state.outlierAdded) {
                // Add Outlier (5000)
                currentArr.push(5000);
                btn.innerText = "ğŸ”„ ãƒªã‚»ãƒƒãƒˆ";
                btn.classList.replace('bg-orange-500', 'bg-gray-500');
                btn.classList.replace('hover:bg-orange-600', 'hover:bg-gray-600');
                state.outlierAdded = true;
            } else {
                // Reset
                btn.innerText = "ğŸ’° è¶…å¯Œè£•å±¤ (å¹´å5000ä¸‡) ã‚’è¿½åŠ ";
                btn.classList.replace('bg-gray-500', 'bg-orange-500');
                btn.classList.replace('hover:bg-gray-600', 'hover:bg-orange-600');
                state.outlierAdded = false;
            }

            // Calc
            const sum = currentArr.reduce((a,b)=>a+b,0);
            const mean = Math.round(sum / currentArr.length);
            
            const sorted = [...currentArr].sort((a,b)=>a-b);
            const mid = Math.floor(sorted.length/2);
            const median = sorted.length % 2 !== 0 ? sorted[mid] : (sorted[mid-1]+sorted[mid])/2;

            meanDisplay.innerText = mean;
            medianDisplay.innerText = median;
            
            // Highlight changes
            meanDisplay.classList.add('scale-110');
            setTimeout(()=>meanDisplay.classList.remove('scale-110'), 200);
        }

        // --- Quiz System ---
        const questions = [
            { q: "IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãƒ‰ãƒ¡ã‚¤ãƒ³åã‚’å¯¾å¿œã•ã›ã‚‹ä»•çµ„ã¿ã¯ï¼Ÿ", options: ["DHCP", "DNS", "HTTP", "SSL"], ans: 1 },
            { q: "äºŒåˆ†æ¢ç´¢ã‚’è¡Œã†ãŸã‚ã®å¿…é ˆæ¡ä»¶ã¯ï¼Ÿ", options: ["ãƒ‡ãƒ¼ã‚¿æ•°ãŒå¤šã„ã“ã¨", "ãƒ‡ãƒ¼ã‚¿ãŒæ•´åˆ—æ¸ˆã¿ã§ã‚ã‚‹ã“ã¨", "ãƒ‡ãƒ¼ã‚¿ãŒæ•°å€¤ã§ã‚ã‚‹ã“ã¨", "ä¹±æ•°ã‚’ä½¿ã†ã“ã¨"], ans: 1 },
            { q: "ã‚¢ãƒŠãƒ­ã‚°ä¿¡å·ã‚’ãƒ‡ã‚¸ã‚¿ãƒ«åŒ–ã™ã‚‹3æ®µéšã®æ­£ã—ã„é †åºã¯ï¼Ÿ", options: ["é‡å­åŒ–â†’æ¨™æœ¬åŒ–â†’ç¬¦å·åŒ–", "æ¨™æœ¬åŒ–â†’é‡å­åŒ–â†’ç¬¦å·åŒ–", "ç¬¦å·åŒ–â†’æ¨™æœ¬åŒ–â†’é‡å­åŒ–", "æ¨™æœ¬åŒ–â†’ç¬¦å·åŒ–â†’é‡å­åŒ–"], ans: 1 },
            { q: "å¤–ã‚Œå€¤ã®å½±éŸ¿ã‚’æœ€ã‚‚å—ã‘ã«ãã„ä»£è¡¨å€¤ã¯ï¼Ÿ", options: ["å¹³å‡å€¤", "æœ€å¤§å€¤", "ä¸­å¤®å€¤", "åˆè¨ˆ"], ans: 2 },
            { q: "è‘—ä½œæ¨©æ³•ã«ãŠã„ã¦ã€è¨±è«¾ãªãè¡Œãˆã‚‹è¡Œç‚ºã¯ï¼Ÿ", options: ["å‹äººã«ã‚³ãƒ”ãƒ¼ã—ã¦é…ã‚‹", "SNSã‚¢ã‚¤ã‚³ãƒ³ã«åˆ©ç”¨", "ç§çš„ä½¿ç”¨ã®ãŸã‚ã®è¤‡è£½", "å•†ç”¨ã‚µã‚¤ãƒˆã¸ã®è»¢è¼‰"], ans: 2 }
        ];

        function renderQuiz() {
            const container = document.getElementById('quiz-container');
            container.innerHTML = "";
            document.getElementById('quiz-result').classList.add('hidden');
            
            // Shuffle questions simply
            const shuffled = [...questions].sort(() => 0.5 - Math.random());
            
            shuffled.forEach((item, idx) => {
                const qDiv = document.createElement('div');
                qDiv.className = "card bg-white p-4 shadow-sm border border-gray-100";
                
                let optsHtml = "";
                item.options.forEach((opt, optIdx) => {
                    optsHtml += `
                        <div class="flex items-center mt-2">
                            <input type="radio" name="q${idx}" value="${optIdx}" id="q${idx}_${optIdx}" class="quiz-option hidden" data-correct="${optIdx === item.ans}">
                            <label for="q${idx}_${optIdx}" class="w-full px-4 py-2 border rounded cursor-pointer hover:bg-gray-50 transition select-none text-sm">
                                ${opt}
                            </label>
                        </div>
                    `;
                });

                qDiv.innerHTML = `
                    <p class="font-bold text-gray-800 mb-2">Q${idx+1}. ${item.q}</p>
                    <div class="space-y-1">${optsHtml}</div>
                    <div class="feedback hidden mt-2 text-sm font-bold p-2 rounded"></div>
                `;
                container.appendChild(qDiv);
            });
        }

        function checkQuiz() {
            let score = 0;
            const qDivs = document.getElementById('quiz-container').children;
            
            for (let i = 0; i < qDivs.length; i++) {
                const inputs = qDivs[i].querySelectorAll('input');
                const feedback = qDivs[i].querySelector('.feedback');
                let answered = false;
                
                inputs.forEach(input => {
                    if (input.checked) {
                        answered = true;
                        if (input.dataset.correct === "true") {
                            score++;
                            feedback.innerHTML = "â­• æ­£è§£ï¼";
                            feedback.className = "feedback mt-2 text-sm font-bold p-2 rounded bg-green-100 text-green-700 block";
                        } else {
                            feedback.innerHTML = "âŒ ä¸æ­£è§£...";
                            feedback.className = "feedback mt-2 text-sm font-bold p-2 rounded bg-red-100 text-red-700 block";
                        }
                    }
                    input.disabled = true; // Lock
                });

                if(!answered) {
                     feedback.innerHTML = "âš ï¸ æœªå›ç­”";
                     feedback.className = "feedback mt-2 text-sm font-bold p-2 rounded bg-yellow-100 text-yellow-700 block";
                }
            }

            const resultBox = document.getElementById('quiz-result');
            resultBox.classList.remove('hidden');
            document.getElementById('quiz-score').innerText = `${score} / ${qDivs.length}`;
            
            let comment = "";
            if(score === qDivs.length) comment = "ç´ æ™´ã‚‰ã—ã„ï¼å®Œç’§ãªç†è§£åº¦ã§ã™ ğŸ‰";
            else if(score >= qDivs.length * 0.6) comment = "è‰¯ã„èª¿å­ã§ã™ï¼é–“é•ãˆãŸç®‡æ‰€ã‚’å¾©ç¿’ã—ã¾ã—ã‚‡ã† ğŸ‘";
            else comment = "ã‚‚ã†ä¸€åº¦è§£èª¬ã‚¿ãƒ–ã‚’èª­ã‚“ã§å†æŒ‘æˆ¦ã—ã¾ã—ã‚‡ã† ğŸ’ª";
            
            document.getElementById('quiz-comment').innerText = comment;
            resultBox.scrollIntoView({behavior: 'smooth'});
        }

        // Init tabs
        switchTab('overview');

    </script>
</body>
</html>